# 前言
首先明确，因为电信宽带独有拨号模式的关系（闪讯），不支持电信用户使用这个技巧。

相关用户请自行寻找闪讯的相关文章。

这个文章写作的目的是：不使用学校提供的ZUCC_VPN软件进行拨号（特殊情况下会有非常高的CPU占用），而使用Windows10内置的功能进行相应请求。依此可以实现开机后自动拨号联网的相关操作，比较方便。

# 初始化

首先拿DiE查一下程序壳（不是），显然是用VB6.0写的。考虑到相关的逆向工程成果已经很丰富了，直接拿工具套一套就行。

这里使用的工具是VBRezQ。

#  文件树

逆向后的文件树如下：

-  CLASS03.CLS

    存放类声明
-  FORM01.FRM

    存放库框体结构
-  MODULE02.BAS

    存放函数

显然分析MODULE02.BAS内的函数即可。


# 函数分析/拨号文件获取

观察到主要子程序内有如下几行：

```Basic
'N  * ref: "\ZUCCVPN.pbk"
'N  * ref: __vbaStrCat
'N  * ref: __vbaStrMove
'N  * ref: __vbaFreeStr`
```
（其他代码略去）

分析得知程序是通过内置的拨号地址、模式等信息，结合用户输入的账号、密码构造一个pbk文件进行拨号。
打开行为监测软件，指定对应进程，在拨号成功之前将pbk文件取出即可；不必分析BAS内每一个函数的作用。



#  自行拨号

利用Windows10内置的添加VPN即可模拟相应的请求。

从pbk文件中获得的配置如下：

- 常规页签
    -  IP地址为192.168.200.1
- 选项页签
  - PPP设置：LCP扩展，启用软件压缩。
  - 记住凭据
- 安全页签
  - L2TP/IPsec协议
  - 可选加密
  - 未加密的密码，质询握手身份协议
  - MS CHAP v2

其余页签不执行任何操作。

点击Windows10设置应用-网络-VPN，按照向导添加一个VPN。相关参数任意填写即可，用户名与密码需要正确输入。

然后进入更改适配器选项页面（Legacy应用，归属于控制面板），找到刚刚配置的VPN，右键属性；逐项填写上述pbk内的配置即可。

最后，单击任务栏左下角的网络图标，找到配置的VPN，连接即可。


#  后记

Windows10设置应用在更新了7年以后仍然处于残废状态……连个VPN属性更改都要掘地三尺才能找到。

不仅是网络，所有的设置项基本都要搬出控制面板才能进行细致的修改；然而使用一些浅层功能会把你重定向到设置应用等内置UWP组件里面，于是你就在这两个应用之间反复横跳浪费时间。接着你就会体验到UWP这个有人生没人管的东西的精妙之处，具体体验包括但不限于占据界面30%的无法关闭广告、响应时间3秒起的常用组件、一个UWP崩掉导致整个Shell Experience Host崩溃，进而导致所有应用炸掉的情况。。

只能说微软大公司病太严重根本没资源完善这个屎坑，于是用户没得选就只能选择在下面接着。。
